apiVersion: policy.open-cluster-management.io/v1alpha1
kind: PolicyShepherd
metadata:
  name: policyshepherd-sample
spec:
  policyList:
  - |
    {"id":"fe9de18b-86db-44d5-a7c4-74173ccffe2e","name":"Privileged Container","description":"Alert on deployments with containers running in privileged mode","rationale":"Containers running as privileged represent greater post-exploitation risk by allowing an attacker to access all host devices, run a daemon in the container, etc.","remediation":"Verify that privileged capabilities are required and cannot be provided with a subset of other controls.","disabled":false,"categories":["Privileges","Docker CIS"],"fields":null,"lifecycleStages":["DEPLOY"],"whitelists":[],"exclusions":[{"name":"Don't alert on the stackrox namespace","deployment":{"name":"","scope":{"cluster":"","namespace":"stackrox","label":null}},"image":null,"expiration":null},{"name":"Don't alert on kube-system namespace","deployment":{"name":"","scope":{"cluster":"","namespace":"kube-system","label":null}},"image":null,"expiration":null},{"name":"Don't alert on istio-system namespace","deployment":{"name":"","scope":{"cluster":"","namespace":"istio-system","label":null}},"image":null,"expiration":null},{"name":"Don't alert on openshift-node namespace","deployment":{"name":"","scope":{"cluster":"","namespace":"openshift-node","label":null}},"image":null,"expiration":null},{"name":"Don't alert on openshift-sdn namespace","deployment":{"name":"","scope":{"cluster":"","namespace":"openshift-sdn","label":null}},"image":null,"expiration":null}],"scope":[],"severity":"MEDIUM_SEVERITY","enforcementActions":[],"notifiers":[],"lastUpdated":null,"SORTName":"Privileged Container","SORTLifecycleStage":"DEPLOY","SORTEnforcement":false,"policyVersion":"1.1","policySections":[{"sectionName":"","policyGroups":[{"fieldName":"Privileged Container","booleanOperator":"OR","negate":false,"values":[{"value":"true"}]}]}]}
